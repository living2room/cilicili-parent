<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="../css/style.css"/>
		<script src="/webjars/jquery/3.2.1/dist/jquery.min.js"></script>
	</head>
	
	<body>
		<div class="top">
			<div class="nav">
				<div class="logo"><img src="../img/LOGO01.png" ></div>
				<div id="box">
					<input type="text" id="box_sousuo" name="search" placeholder="请输入关键字">
					<div id="search">搜索</div> 
				</div>
				<div class="nav_right">
					<div class="shouye">
						<div class="tubiao"><img src="../img/shouye.png" ></div>
						<div class="nav_text"><a href="index.html"  style="color: #00b7ee;">首页</a></div>
					</div>
					<div class="shcngchuan">
						<div class="tubiao"><img src="../img/shangchuan.png" ></div>
						<div class="nav_text"><a href="#">上传</a></div>
					</div>
					<div class="shcngchuan">
						<div class="tubiao"><img src="../img/tuiguang.png" ></div>
						<div class="nav_text"><a href="#">推广</a></div>
					</div>
					<div class="shcngchuan">
						<div class="tubiao"><img src="../img/huiyuan.png" ></div>
						<div class="nav_text"><a href="#">会员</a></div>
					</div>
					<div class="shcngchuan">
						<div class="tubiao"><img src="../img/yonghu.png" ></div>
						<div class="nav_text"><a href="Login.html">登录</a></div>
					</div>
				</div>
			</div>
		</div>
		<div class="password01_top_img"></div>
		<div class="password01_nav">
			<div class="password01_nav_text">
				<a href="Login.html">登录</a>&nbsp;>&nbsp;修改密码
			</div>
		</div>
	    <br>
	    <br>
	    <br>
		
		<div class="input-group " style="margin-left: 750px;">
			<span class="input-group-addon">旧密码</span>
			<input type="password" name="userPassword" id="userPassword" class="form-control" placeholder="请输入您要旧密码" style="width: 330px;" >
		</div><label id="p"></label>
		<!-- </div><p id="p1"></p>
 -->		<br />
		<div class="input-group" style="margin-left: 750px;">
			<span class="input-group-addon"> 新密码</span>
			<input type="password" name="newPassword" id="newPassword" class="form-control" placeholder="请输入您要 新密码" style="width: 330px;">
		</div><label id="np"></label>
		
		<br />
		<br />
		<button type="button" id="ok" class="btn btn-primary" style="height: 40px;width: 300px;background: #00a1d6;font-size: 16px;margin-left: 810px;border: none;">确认修改</button>
	<input type="hidden" id="userName" th:value="${session.userName}">

	<script type="text/javascript">
			$("#ok").click(function() {
				var userPassword = $("#userPassword").val();
				var newPassword = $("#newPassword").val();
				if (newPassword == "" || newPassword == null) {
					$("#newPassword").focus();
					$("#newPassword").css("color", "red");
					$("#np").html("请输入新密码");
					return false;
				} else if (userPassword == "" || userPassword == null) {
					$("#userPassword").focus();
					$("#userPassword").css("color", "red");
					$("#p").html("请输入旧密码");
					return false;
				} else {
					$.ajax({
						type : "POST",
						url : "/user/upPassword",
						data : {
							"newPassword" : $("#newPassword").val(),
							"userPassword" : $("#userPassword").val(),
							"userName" : $("#userName").val(),
						},
						dataType : "json", 
						
						 success : function(data) {
							if (data["msg"] == 1) {
								$("#np").html("修改成功");
								(function() {
									location.href = "/user/index";
								})();
							}else if (data["msg"] == 0){
								$("#p").html("旧密码输入错误");
							/* 	(function() {
									location.href = "/user/index";
								})(); */
							}
						},
						error : function(data) {
								//alert("邮箱或密码错误");	
								$("#np").html("提交失败"+data);	
						} 

					});

				}
			});
	</script>	
		
		
	</body>
</html>
