<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>

       <!-- 全局css -->
    <link rel="stylesheet" type="text/css" href="/webjars/bootstrap/3.4.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/plugins/DPlayer/DPlayer.min.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <!--自定义css  -->
	<link rel="stylesheet" type="text/css" href="/css/stylef.css"/>
	<link rel="stylesheet" type="text/css" href="/css/base.css"/>
	<link rel="stylesheet" type="text/css"  href="/css/pinglun.css">
	<link rel="stylesheet" type="text/css"  href="/css/pinglun_style.css">

    <!-- 全局js -->
    <script type="text/javascript" src="/webjars/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="/webjars/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/plugins/DPlayer/DPlayer.min.js"></script>
	<script type="text/javascript" src="/js/jquery.flexText.js"></script>

	</head>
	<body>
		<!-------------------------------------------- 导航栏 ------------------------------------------------->
			<div class="top">
			<div class="nav">
				<div class="logo"><img src="/img/LOGO01.png" ></div>
				<div id="box">
					<input type="text" id="box_sousuo" name="search" placeholder="请输入关键字">
					<div id="search">搜索</div>
				</div>
				<div class="nav_right">
					<div class="shouye">
							<div class="tubiao">
								<img src="../img/shouye.png">
							</div>
							<div class="nav_text">
								<a href="/to/home" style="color: #00b7ee;">首页</a>
							</div>
						</div>
						<div class="shcngchuan">
							<div class="tubiao">
								<img src="../img/shangchuan.png">
							</div>
							<div class="nav_text">
								<a href="/to/up">上传</a>
							</div>
						</div>
						<div class="shcngchuan">
							<div class="tubiao">
								<img src="../img/tuiguang.png">
							</div>
							<div class="nav_text">
								<a href="/Message/reveiceBox">消息</a>
							</div>
						</div>
						<div class="shcngchuan">
							<div class="tubiao">
								<img src="../img/huiyuan.png">
							</div>
							<div class="nav_text">
								<a href="/PaymentBuyVip/Buy">会员</a>
							</div>
						</div>
				<div class="shcngchuan">
					<
					<!-- div class="tubiao"><img src="../img/yonghu.png" ></div>
						<div class="nav_text"><a href="Login.html">登录</a></div> -->
					<div th:if="${session.user}">
						<a
							th:href="@{'/message/usersMessage?userName='+${session.userName}}"><div
								id="view1"
								style="width: 50px; height: 50px; -moz-background-size: 100% 100%; background-size: 100% 100%; border-radius: 50%;">
							</div></a>
					</div>
					<div class="shcngchuan">
						<a href="shangchuan.html">
							<div class="tubiao"><img src="/img/shangchuan.png" ></div>
							<div class="nav_text">上传</div>
						</a>
					</div>
					<div class="shcngchuan">
						<a href="/Message/reveiceBox">
							<div class="tubiao"><img src="/img/tuiguang.png" ></div>
							<div class="nav_text">推广</div>
						</a>
					</div>
					<div class="shcngchuan">
						<a href="/PaymentBuyVip/Buy" >
							<div class="tubiao"><img src="/img/huiyuan.png"></div>
							<div class="nav_text">会员</div>
						</a>
					</div>
                <div class="shcngchuan">

                    <div th:if="${session.user}">
                    <a th:href="@{'/message/usersMessage?userName='+${session.userName}}"><div id="view1" style="width: 50px;
                     height: 50px;-moz-background-size:100% 100%; background-size:100% 100%; border-radius: 50%;">
                    </div></a>

                    </div>
                        <div th:unless="${session.user}">
                            <a href="/user/toLogin">
                                <div class="tubiao">
                                    <img src="/img/yonghu.png">
                                </div>
                                <div class="nav_text">登录</div>
                            </a>
                        </div>
                    </div>
				</div>
			</div>
		</div>
		<!-------------------------------------------- 导航栏 ------------------------------------------------->
			<!----------------------------- 视频内容部分开始	 ----------------------------------->
			<div class="shiping_con">
					<div class="shiping_con_top">
						<div class="top_left">
							<div th:text="${detail.videoTitle}" class="top_left1">岂有此理，又被这个小学生摆了一道！爆笑视频</div>
							<div class="top_left2"> [[${detail.videoPlayed}]]播放 · [[${detail.bulletScreenNum}]]弹幕  &nbsp;&nbsp;  [[${detail.videoUploadTime}]]</div>
						</div>
						<div class="top_right"></div>
					</div>


					<div class="Dplayer_box">
						<div class="player_av">
							<div id="player1"></div>
						</div>
						<div class="Dplayer_danmu">
							<div class="Dplayer_watching">
								<span class="Dplayer-watching-number" title="这个数据是假的">24</span>
								人正在观看,<span class="danmuku_num">100</span>条弹幕
							</div>

							<ul class="Dplayer_list">
								<li>时间</li>
								<li>发送内容</li>
								<li>用户类型</li>
							</ul>
							<ul class="list_ovefiow">

							</ul>

						</div>
					</div>

					<div class="alert_back">加载中</div>



					<!---------------------------- 评论模块开始 ----------------------------------------------->
					<div class="pinglun_box">
						<div class="commentAll" style="width: 980px;border: solid 1px #dbdbdb;">
						    <!--评论区域 begin-->
						    <div class="reviewArea clearfix">
						        <textarea class="content comment-input" placeholder="请输入您的精彩评论吧&hellip;" onkeyup="keyUP(this)"></textarea>
						        <a href="javascript:;" class="plBtn" style="background: #00a1d6;">评论</a>
						    </div>
						    <!--评论区域 end-->
						    <!--回复区域 begin-->
						    <div class="comment-show">
						        <div class="comment-show-con clearfix">
						            <div class="comment-show-con-img pull-left"><img src="/img/header-img-comment_03.png" alt=""></div>
						            <div class="comment-show-con-list pull-left clearfix">
						                <div class="pl-text clearfix">
						                    <a href="#" class="comment-size-name">叫我小姐姐 : </a>
						                    <span class="my-pl-con">&nbsp;外国人真可怜，这么惊讶都不会说“卧槽！”</span>
						                </div>
						                <div class="date-dz">
						                    <span class="date-dz-left pull-left comment-time">2019-6-23 08:16:39</span>
						                    <div class="date-dz-right pull-right comment-pl-block">
						                        <a href="javascript:;" class="removeBlock">删除</a>
						                        <a href="javascript:;" class="date-dz-pl pl-hf hf-con-block pull-left" >回复</a>
						                        <span class="pull-left date-dz-line">|</span>
						                        <a href="javascript:;" class="date-dz-z pull-left"><i class="date-dz-z-click-red"></i>赞 (<i class="z-num">0</i>)</a>
						                    </div>
						                </div>
						                <div class="hf-list-con"></div>
						            </div>
						        </div>
						    </div>
						    <!--回复区域 end-->
						</div>


					</div>
					<!---------------------------- 评论模块结束 ----------------------------------------------->


					<!---------------------------- 相关视频推荐开始 ------------------------------------------------>
					<div class="xiangguan">
						<div class="xiangguan_text">相关推荐</div>
						<div class="xiangguan_box2" style="margin-top: 0;">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>
						<div class="xiangguan_box2">
							<div class="xiangguan_shiping_box"></div>
							<div class="xiangguan_shiping_text">
								<div class="text1_box" title="大雄不停往天上扔东西，却不停的会掉下来">大雄不停往天上扔东西，却不停的会掉下来</div>
								<div class="text2_box">UP : &nbsp;隔壁老王</div>
								<div class="text3_box">635播放&nbsp;·&nbsp;16弹幕</div>
							</div>
						</div>

					<!---------------------------- 相关视频推荐结束 ------------------------------------------------>
					</div>

			</div>

			<div class="footer">
				<div id="box94"></div>
				<div class="footer_con">
					<form>
						<div class="footer_con1">
							<input type="text" name="" id="footer_text" value="" style="border: none;" />
							<div class="footer_button">
								<input type="reset" id="chongzhi" value="清空内容" style="border: none;"/>
								<input type="submit" id="tijiao" value="提交建议" style="border: none;" />
							</div>

						</div>
					</form>
					<div class="footer_lianjie">
						<ul>
							<li>友情链接：</li>
							<li><a href="http://www.gxstnu.edu.cn/">广西科技师范学院</a></li>
							<li><a href="https://ai.taobao.com/">淘宝网</a></li>
							<li><a href="https://www.jd.com/">京东商城</a></li>
							<li><a href="https://www.bilibili.com/">哔哩哔哩</a></li>
							<li><a href="http://www.iqiyi.com/">爱奇艺</a></li>
							<li><a href="https://v.qq.com/">腾讯视频</a></li>
							<li><a href="https://pan.baidu.com/">百度云</a></li>
							<li><a href="https://www.tmall.com/">天猫超市</a></li>
							<li><a href="https://nba.hupu.com/">虎扑体育</a></li>
							<li><a href="https://music.163.com/">网易云音乐</a></li>
							<li><a href="https://www.youku.com/">优酷</a></li>
							<li><a href="https://www.baidu.com/">百度</a></li>
						</ul>
					</div>
				</div>
			</div>
	<!--textarea高度自适应-->
	<script type="text/javascript">
	    $(function () {
	        $('.content').flexText();
	    });
	</script>
	<!--textarea限制字数-->
	<script type="text/javascript">
	    function keyUP(t){
	        var len = $(t).val().length;
	        if(len > 139){
	            $(t).val($(t).val().substring(0,140));
	        }
	    }
	</script>
	<!--点击评论创建评论条-->
	<script type="text/javascript">
	    $('.commentAll').on('click','.plBtn',function(){
	        var myDate = new Date();
	        //获取当前年
	        var year=myDate.getFullYear();
	        //获取当前月
	        var month=myDate.getMonth()+1;
	        //获取当前日
	        var date=myDate.getDate();
	        var h=myDate.getHours();       //获取当前小时数(0-23)
	        var m=myDate.getMinutes();     //获取当前分钟数(0-59)
	        if(m<10) m = '0' + m;
	        var s=myDate.getSeconds();
	        if(s<10) s = '0' + s;
	        var now=year+'-'+month+"-"+date+" "+h+':'+m+":"+s;
	        //获取输入内容
	        var oSize = $(this).siblings('.flex-text-wrap').find('.comment-input').val();
	        console.log(oSize);
	        //动态创建评论模块
	        oHtml = '<div class="comment-show-con clearfix"><div class="comment-show-con-img pull-left"><img src="/img/header-img-comment_04.png" alt=""></div> <div class="comment-show-con-list pull-left clearfix"><div class="pl-text clearfix"> <a href="#" class="comment-size-name">name : </a> <span class="my-pl-con">&nbsp;'+ oSize +'</span> </div> <div class="date-dz"> <span class="date-dz-left pull-left comment-time">'+now+'</span> <div class="date-dz-right pull-right comment-pl-block"><a href="javascript:;" class="removeBlock">删除</a> <a href="javascript:;" class="date-dz-pl pl-hf hf-con-block pull-left">回复</a> <span class="pull-left date-dz-line">|</span> <a href="javascript:;" class="date-dz-z pull-left"><i class="date-dz-z-click-red"></i>赞 (<i class="z-num">666</i>)</a> </div> </div><div class="hf-list-con"></div></div> </div>';
	        if(oSize.replace(/(^\s*)|(\s*$)/g, "") != ''){
	            $(this).parents('.reviewArea ').siblings('.comment-show').prepend(oHtml);
	            $(this).siblings('.flex-text-wrap').find('.comment-input').prop('value','').siblings('pre').find('span').text('');
	        }
	    });
	</script>
	<!--点击回复动态创建回复块-->
	<script type="text/javascript">
	    $('.comment-show').on('click','.pl-hf',function(){
	        //获取回复人的名字
	        var fhName = $(this).parents('.date-dz-right').parents('.date-dz').siblings('.pl-text').find('.comment-size-name').html();
	        //回复@
	        var fhN = '回复@'+fhName;
	        //var oInput = $(this).parents('.date-dz-right').parents('.date-dz').siblings('.hf-con');
	        var fhHtml = '<div class="hf-con pull-left"> <textarea class="content comment-input hf-input" placeholder="" onkeyup="keyUP(this)"></textarea> <a href="javascript:;" class="hf-pl">评论</a></div>';
	        //显示回复
	        if($(this).is('.hf-con-block')){
	            $(this).parents('.date-dz-right').parents('.date-dz').append(fhHtml);
	            $(this).removeClass('hf-con-block');
	            $('.content').flexText();
	            $(this).parents('.date-dz-right').siblings('.hf-con').find('.pre').css('padding','6px 15px');
	            //console.log($(this).parents('.date-dz-right').siblings('.hf-con').find('.pre'))
	            //input框自动聚焦
	            $(this).parents('.date-dz-right').siblings('.hf-con').find('.hf-input').val('').focus().val(fhN);
	        }else {
	            $(this).addClass('hf-con-block');
	            $(this).parents('.date-dz-right').siblings('.hf-con').remove();
	        }
	    });
	</script>
	<!--评论回复块创建-->
	<script type="text/javascript">
	    $('.comment-show').on('click','.hf-pl',function(){
	        var oThis = $(this);
	        var myDate = new Date();
	        //获取当前年
	        var year=myDate.getFullYear();
	        //获取当前月
	        var month=myDate.getMonth()+1;
	        //获取当前日
	        var date=myDate.getDate();
	        var h=myDate.getHours();       //获取当前小时数(0-23)
	        var m=myDate.getMinutes();     //获取当前分钟数(0-59)
	        if(m<10) m = '0' + m;
	        var s=myDate.getSeconds();
	        if(s<10) s = '0' + s;
	        var now=year+'-'+month+"-"+date+" "+h+':'+m+":"+s;
	        //获取输入内容
	        var oHfVal = $(this).siblings('.flex-text-wrap').find('.hf-input').val();
	        console.log(oHfVal)
	        var oHfName = $(this).parents('.hf-con').parents('.date-dz').siblings('.pl-text').find('.comment-size-name').html();
	        var oAllVal = '回复@'+oHfName;
	        if(oHfVal.replace(/^ +| +$/g,'') == '' || oHfVal == oAllVal){

	        }else {
	            $.getJSON("/json/pl.json",function(data){
	                var oAt = '';
	                var oHf = '';
	                $.each(data,function(n,v){
	                    delete v.hfContent;
	                    delete v.atName;
	                    var arr;
	                    var ohfNameArr;
	                    if(oHfVal.indexOf("@") == -1){
	                        data['atName'] = '';
	                        data['hfContent'] = oHfVal;
	                    }else {
	                        arr = oHfVal.split(':');
	                        ohfNameArr = arr[0].split('@');
	                        data['hfContent'] = arr[1];
	                        data['atName'] = ohfNameArr[1];
	                    }

	                    if(data.atName == ''){
	                        oAt = data.hfContent;
	                    }else {
	                        oAt = '回复<a href="#" class="atName">@'+data.atName+'</a> : '+data.hfContent;
	                    }
	                    oHf = data.hfName;
	                });

	                var oHtml = '<div class="all-pl-con"><div class="pl-text hfpl-text clearfix"><a href="#" class="comment-size-name">我的名字 : </a><span class="my-pl-con">'+oAt+'</span></div><div class="date-dz"> <span class="date-dz-left pull-left comment-time">'+now+'</span> <div class="date-dz-right pull-right comment-pl-block"> <a href="javascript:;" class="removeBlock">删除</a> <a href="javascript:;" class="date-dz-pl pl-hf hf-con-block pull-left">回复</a> <span class="pull-left date-dz-line">|</span> <a href="javascript:;" class="date-dz-z pull-left"><i class="date-dz-z-click-red"></i>赞 (<i class="z-num">0</i>)</a> </div> </div></div>';
	                oThis.parents('.hf-con').parents('.comment-show-con-list').find('.hf-list-con').css('display','block').prepend(oHtml) && oThis.parents('.hf-con').siblings('.date-dz-right').find('.pl-hf').addClass('hf-con-block') && oThis.parents('.hf-con').remove();
	            });
	        }
	    });
	</script>
	<!--删除评论块-->
	<script type="text/javascript">
	    $('.commentAll').on('click','.removeBlock',function(){
	        var oT = $(this).parents('.date-dz-right').parents('.date-dz').parents('.all-pl-con');
	        if(oT.siblings('.all-pl-con').length >= 1){
	            oT.remove();
	        }else {
	            $(this).parents('.date-dz-right').parents('.date-dz').parents('.all-pl-con').parents('.hf-list-con').css('display','none')
	            oT.remove();
	        }
	        $(this).parents('.date-dz-right').parents('.date-dz').parents('.comment-show-con-list').parents('.comment-show-con').remove();

	    })
	</script>
	<!--点赞-->
	<script type="text/javascript">
	    $('.comment-show').on('click','.date-dz-z',function(){
	        var zNum = $(this).find('.z-num').html();
	        if($(this).is('.date-dz-z-click')){
	            zNum--;
	            $(this).removeClass('date-dz-z-click red');
	            $(this).find('.z-num').html(zNum);
	            $(this).find('.date-dz-z-click-red').removeClass('red');
	        }else {
	            zNum++;
	            $(this).addClass('date-dz-z-click');
	            $(this).find('.z-num').html(zNum);
	            $(this).find('.date-dz-z-click-red').addClass('red');
	        }
	    })
	</script>
	<script>
		var url = window.location.href.split("/");
		var vid = url[url.length-1]
		console.log(url);
	    console.log(" %c 该项目基于Dplayer.js",'color:red')
	    var dp = new DPlayer({
	        element: document.getElementById('player1'),
	        autoplay: false,
	        video: {
	            url: "[[${detail.actualUrl}]]",
	            // url: "http://172.18.83.151/data/video/【韩国内双麻麻Lisa分享】韩国博主示范“和粗腿说再见！躺着就可以练出漂亮的腿型！” - 1.v1(Av56771800,P1).mp4",
	            pic: "[[${detail.picUrl}]]"
	        },
	        danmaku: {
	            id: 'demo',
	            api: 'https://api.prprpr.me/dplayer/',
	            maximum: 1000,
	            addition: ['https://api.prprpr.me/dplayer/bilibili?aid=15572523']
	        }
	    });
	    // 弹出框
	    function alert_back(text) {
	        $(".alert_back").html(text).show();
	        setTimeout(function () {
	            $(".alert_back").fadeOut();
	        },1200)
	    }
	    //秒转分秒
	    function formatTime(seconds) {
	        return [
	//            parseInt(seconds / 60 / 60),
	            parseInt(seconds / 60 % 60),
	            parseInt(seconds % 60)
	        ]
	            .join(":")
	            .replace(/\b(\d)\b/g, "0$1");
	    }
	$.ajax({
	    url:"https://api.prprpr.me/dplayer/bilibili?aid=15572523",
	    success:function (data) {
	        if(data.code=="1"){
	            var danmaku=data.danmaku;
	            var autor="农民";
	            $(".danmuku_num").text(danmaku.length)
	            $(danmaku).each(function (index,item) {
	                if(item.type=="right"){
	                }else
	                {
	                    autor="地主"
	                }
	                // var oLi='<ol class="danmuku_list" time="${item.time}"><li>${formatTime(item.time)}</li><li title="${item.text}">${item.text}</li><li>${autor}</li></ol>'

	                $(".list_ovefiow").append(oLi);
	                autor="农民";
	            })
	        }else {
	            alert_back("弹幕加载失败 -v-!");
	        }
	        $(".danmuku_list").on("click",function () {

	            dp.seek( $(this).attr("time"))
	        })
	    }
	})
	</script>

		</body>
		</html>