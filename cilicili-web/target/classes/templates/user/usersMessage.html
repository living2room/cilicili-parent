<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="robots" content="all">
<title></title>
<meta name="keywords" content="">
<meta name="description" content="">
<link rel="stylesheet" type="text/css" href="../css/ycbootstrap.css" />
<link rel="stylesheet" type="text/css" href="../css/reset2.css" />
<link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="../css/stylef.css" />

<script src="../js/jquery-1.9.1.js" type="text/javascript"></script>
<!-- 搜索框的 -->
<script type="text/javascript" src="/js/bootstrap-suggest.min.js"></script>
<!-- 搜索框的 -->
<script src="../plugins/cover_js/iscroll-zoom.js" type="text/javascript"
	charset="utf-8"></script>
<script src="../plugins/cover_js/hammer.js" type="text/javascript"
	charset="utf-8"></script>
<script src="../plugins/cover_js/lrz.all.bundle.js"
	type="text/javascript" charset="utf-8"></script>
<script src="../plugins/cover_js/jquery.photoClip.min.js"
	type="text/javascript" charset="utf-8"></script>
		

</head>
<body>
	<div class="top">
		<div class="nav">
			<div class="logo">
				<img src="../img/LOGO01.png">
			</div>
		<!-- 搜索框的 -->
				<div id="box">
					<div class="input-group" style="width: 175px;">
						<input type="text" class="form-control" id="box_sousuo"
							placeholder="嗖(。≖ˇェˇ≖｡)...">
						<div class="input-group-btn">
							<button type="button" class="btn btn-default dropdown-toggle"
								data-toggle="dropdown">
								<span class="caret"></span>
							</button>
							<ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
						</div>
						<!-- /btn-group -->
					</div>
				</div>
				<!-- 搜索框的 -->
			<div class="nav_right">
				<div class="shouye">
					<div class="tubiao">
						<img src="../img/zhuye_an.png">
					</div>
					<div class="nav_text">
						<a href="/to/home">首页</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/shangchuan.png">
					</div>
					<div class="nav_text">
						<a href="/to/up">上传</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/tuiguang.png">
					</div>
					<div class="nav_text">
						<a href="/Message/reveiceBox">消息</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/huiyuan.png">
					</div>
					<div class="nav_text">
						<a href="/PaymentBuyVip/Buy">会员</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
					
					
					<!-- <img src="../img/yonghu.png"> -->
					<a th:href="@{'/message/usersMessage?userName='+${session.userName}}"><div id="view1" style="width: 50px; height: 50px;-moz-background-size:100% 100%; background-size:100% 100%; border-radius: 50%;">
					</div></a>
					</div>	
					
					
					
					
					
								
					<!-- <div class="nav_text">
						<a href="Login.html">登录</a>
					</div> -->
					
				</div>
			</div>
		</div>
	</div>

	<div class="ziliao_img"></div>



	<!-- <form method="post" enctype="multipart/form-data"
		action="/message/upUsersMessage"> -->
	<!------------------------- 上传封面开始	 ------------------------>
	<div class="ycupload-mainbox" style="margin-top: 30px;">
		<div class="ycupload-line"></div>
		<div style="min-height: 1px;">
			<div class="container">
				<div class="row">
					<div class="col-md-12 col-sm-12 col-xs-12"
						style="padding-right: 0; padding-left: 200px;">

						<!--<a href="javascript:void(0);" class="cover-uploadBtn">
												<img src="img/yc_uploadimg_06.png"/>
												<div id="clipArea"></div>
												<input type="file" id="file">
												<button id="clipBtn">截取</button>
											</a>
											<div id="view"></div>-->
						<div
							style="min-height: 1px; line-height: 160px; text-align: center; position: relative; padding-left: 340px;"
							ontouchstart="">
							<div class="cover-wrap"
								style="display: none; position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: 10000000; text-align: center;">
								<div class=""
									style="width: 900px; height: 600px; margin: 100px auto; background-color: #FFFFFF; overflow: hidden; border-radius: 4px;">
									<div id="clipArea" style="margin: 10px; height: 520px;"></div>
									<div class=""
										style="height: 56px; line-height: 36px; text-align: center; padding-top: 8px;">
										<button id="clipBtn" type="button"
											style="width: 120px; height: 36px; border-radius: 4px; background-color: #00a1d6; color: #FFFFFF; font-size: 14px; text-align: center; line-height: 36px; outline: none;">确认裁剪</button>
									</div>
								</div>
							</div>



							<div id="view"
								style="width: 118px; height: 118px; border-radius: 50%;"
								title="请上传 321*321 的封面图片">

								<!-- background-image:url(../img/d99b4e0a60ab4c2c89eeb92234bf64f3.jpg); -->


							</div>
							<div style="height: 10px;"></div>
							<div class=""
								style="width: 100px; height: 32px; border-radius: 4px; background-color: #fff; color: #FFFFFF; font-size: 14px; text-align: center; line-height: 32px; outline: none; position: relative; color: #333; border: solid 1px #b8b8b8; margin-left: 8px;">
								选择头像 <input type="file" name="file" id="file"
									style="cursor: pointer; opacity: 0; filter: alpha(opacity = 0); width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	<!------------------------- 上传封面结束	 ------------------------>

	<!-- 	<form method="post" enctype="multipart/form-data"
			action="/message/upUsersMessage"> -->

	<div class="ziliao_con">

		<div class="input-group" style="margin-left: 26px;">
			<span class="input-group-addon" th:utext="${userName}"
				style="border: none; background: #fff; font-size: 18px;">昵称:&nbsp;&nbsp;</span>
			<input type="hidden" id="userName" name="userName"
				th:value="${userName}">
		</div>

		<div class="input-group " style="margin-left: 26px; margin-top: 30px;">
			<span class="input-group-addon"
				style="border: none; background: #fff; font-size: 18px;">性别:&nbsp;&nbsp;</span>
			<!-- <input id="man" type="radio" checked="checked" name="1" />男<input id="woman" type="radio"  name="1"/>女 -->
			<label class="radio-inline" style="font-size: 18px; margin-top: 3px;">
				<input id="man" type="radio" name="sex" value="1"
				style="margin-top: 7px;">男神
			</label> <label class="radio-inline"
				style="font-size: 18px; margin-top: 3px; margin-left: 30px;">

				<input id="woman" type="radio" name="sex" value="2"
				style="margin-top: 7px;">女神
			</label>
		</div>

		<div class="input-group " style="margin-left: 26px; margin-top: 30px;">
			<span class="input-group-addon"
				style="border: none; background: #fff; font-size: 18px;">年龄:&nbsp;&nbsp;</span>
			<input type="text" class="form-control" name="age" id="age"
				th:value="${age}" placeholder="请输入&nbsp;1-120&nbsp;之间的数字"
				style="width: 280px;">
		</div>
		<label id="a" style="margin-left: 100px;"></label>

		<div class="input-group " style="margin-left: 26px; margin-top: 30px;">
			<span class="input-group-addon"
				style="border: none; background: #fff; font-size: 18px;">手机:&nbsp;&nbsp;</span>
			<input type="text" id="phone" name="phone" th:value="${phone}"
				class="form-control" placeholder="请输入您的手机号码" style="width: 280px;">
		</div>
		<label id="p" style="margin-left: 100px;"></label>

		<div class="input-group " style="margin-left: 26px; margin-top: 30px;">
			<span class="input-group-addon"
				style="border: none; background: #fff; font-size: 18px;">Q&nbsp;Q:&nbsp;&nbsp;</span>
			<input type="text" id="qq" name="qq" th:value="${qq}"
				class="form-control" placeholder="请输入您的QQ号码" style="width: 280px;">
		</div>
		<label id="q" style="margin-left: 100px;"></label>

		<div class="input-group " style="margin-left: 26px; margin-top: 30px;">
			<span class="input-group-addon"
				style="border: none; background: #fff; font-size: 18px;">家乡:&nbsp;&nbsp;</span>
			<input type="text" id="home" class="form-control" name="home"
				th:value="${home}" placeholder="例:&nbsp;&nbsp;&nbsp;广西-玉林"
				style="width: 280px;">
		</div>
		<label id="h" style="margin-left: 100px;"></label>


		<div class="shuoming_con1"
			style="margin-top: 30px; margin-left: 62px;">
			<button type="button" id="ok" class="btn btn-primary"
				style="height: 40px; width: 120px; background: #00a1d6; font-size: 16px; border: none; float: left;">保存</button>
			<button type="reset" class="btn btn-primary"
				style="height: 40px; width: 120px; background: #00a1d6; font-size: 16px; border: none; margin-left: 50px; float: left;">清空</button>
		</div>

	</div>
	<input id="base64" name="base64" type="hidden">

	<!-- </form> -->

	<input type="hidden" id="sexvalue" th:value="${sex}">
	<!-- <input type="hidden" id="img" th:value="${url1}"> -->
	<input type="hidden" id="img" th:value="${session.url1}">


	<script type="text/javascript">			
		
	
		
		$("#ok").click(function() {
			
			
			//var a =$("#phone").blur(function(){	
  　  	 /*    var phone = document.getElementById('phone').value;
  　  	    if(phone==""){
  　  	    	$("#p").text("");
 　  	    	 return true;
 　  	    	}
  　  	   else  if(!(/^1[3456789]\d{9}$/.test(phone))){ 
  　  	        //alert("手机号码有误，请重填");
  　  	        $("#phone").focus();
  　  	        $("#p").text("请输入正确的电话号码");
  　  	        return false; 
  　  	    }
  　  	  //  else{
  　  	    //	$("#p").text("");
  　  	    //	 return true;
  　  	    	//}
  　  	    
		//});	 
	
	//var b = $("#qq").blur(function(){	
		var qq = $("#qq").val();
		var pattern2 =/^[1-9][0-9]{4,11}$/;
		//var pattern2 = /^\d+$|^\d+[.]?\d+$/;
		if(qq==""){
  	    	$("#q").text("");
 	    	 return true;
 	    	}
		if(!pattern2.test(qq)){
			$("#qq").focus();
  	        $("#q").text("请输入正确的qq号码");
  	        return false; 	
			} 
		//else{
  　  	    //	$("#q").text("");
 　  	    	// return true;
 　  	    	//}
	//});
	
	//var c =$("#age").blur(function(){		
		var age = $("#age").val();
		var pattern3 =/^(?:0|[1-9][0-9]?|120)$/;
		if(age==""){
  	    	$("#a").text("");
 	    	 return true;
 	    	}
		if(!pattern3.test(age)){
			 $("#age").focus();
  	        $("#a").text("请输入正确的年龄");
  	        return false; 	
			}  */
		//else{
  　  	    	//$("#a").text("");
 　  	    	// return true;
 　  	    	//}
	//}); 
			
			
			
	
	
			
			//var pattern = /0?(13|14|15|17|18|19)[0-9]{9}/,
     		//str = document.getElementById('phone').value;
  　  	    
  　  	    //alert("1");
			var userName = $("#userName").val();
			var sex =	$('input[name=sex]:checked').val();	
			var base64 = $("#base64").val();
			var home = $("#home").val();
			var phone = $("#phone").val();
			var qq = $("#qq").val();
			var age = $("#age").val();
			
			
			//alert("2");
			//var pattern3 =/^(?:0|[1-9][0-9]?|120)$/;
			var pattern3 =/^(?:[1-9][0-9]?|1[01][0-9]|120)$/;
			var pattern2 =/^[1-9][0-9]{4,11}$/;
			
			
			//年龄
			if(age==""){
	  	    	$("#a").text("");
	 	    	 //return true;
	 	    	}
			else if($("#age").val()=="无" ||$("#age").val()==''){
				//alert("age");
				var age = 0;
				 //return true; 
			}/* else{
				var age = $("#age").val();
				} */
			else if(!pattern3.test(age)){
				//alert("flase");
				 $("#age").focus();
	  	        $("#a").text("请输入正确的年龄");
	  	        return false; 
				} 
			else if(pattern3.test(age)){
				//alert("true");
	  	        $("#a").text("");
	  	        //return true;
				}
			
			
			//alert("3");
	  　  	    if(phone==""){
	  　  	    	$("#p").text("");
	 　  	    	 //return true;
	 　  	    	}
	  　  	   else  if(!(/^1[3456789]\d{9}$/.test(phone))){ 
	  　  	        //alert("手机号码有误，请重填");
	  　  	        $("#phone").focus();
	  　  	        $("#p").text("请输入正确的电话号码");
	  　  	        return false; 
	  　  	    }
	  　  	    //alert("");
	  　  	  //  else{
	  　  	    //	$("#p").text("");
	  　  	    //	 return true;
	  　  	    	//}
	  　  	    
			//});	 
		
		//var b = $("#qq").blur(function(){	
			//var pattern2 = /^\d+$|^\d+[.]?\d+$/;
			if(qq==""){
	  	    	$("#q").text("");
	 	    	 //return true;
	 	    	}
			else if(!pattern2.test(qq)){
				$("#qq").focus();
	  	        $("#q").text("请输入正确的qq号码");
	  	        return false; 	
				}else{
					$("#q").text("");
				}
			//else{
	  　  	    //	$("#q").text("");
	 　  	    	// return true;
	 　  	    	//}
		//});
		
		//var c =$("#age").blur(function(){		
		
					
			$.ajax({
					type : "POST",
					url : "/message/upUsersMessage",
					data : {
						"userName" :userName,
						"base64" :base64,
						"home" : home,
						"phone" : phone,
						"age" : age,
						"qq" : qq,
						"sex" : sex	
					}, 
					
					dataType : "json",

					success : function(data) {
						if (data["msg"] == 1) {
							alert("修改成功");
							(function() {
								location.href = "/message/usersMessage?userName="+$("#userName").val();
							})();
						} else{
							alert("修改失败");					
						} 
					},
					error : function(data) {
						alert("提交失败");
					}
	 			});
			
		});
		
		
	</script>

	<!-- 登录按钮替换为头像 -->
	<script type="text/javascript">
	var img6 = $("#img").val();
	var img5 ="url("+img6+")";
	$("#view1").css('background-image',img5);	
	</script>
	

	<script type="text/javascript">
		$(function() {
			//var username = $("#email").val();
			var sex = $("#sexvalue").val();
			if (sex == 2) {
				$("#woman").attr("checked", "checked");
				//$("#man").attr("checked", "false");
				//$("#man").addClass("layui-btn-disabled");

			} else if (sex == 1) {
				$("#man").attr("checked", "checked");
				//$("#woman").attr("checked", "false");
			}
		});
		var img1 = $("#img").val();
		var img3 ="url("+img1+")";
		$('#view').css('background-image',img3);	
	</script>


	<script type="text/javascript">
		//var img = localStorage.getItem('dataUrl');
		//var img1 = "url(" + img + ")";
		//console.log(img1);
		//console.log(localStorage.getItem('dataUrl'));		 
		//$('#view').css('background-image','url(../img/d99b4e0a60ab4c2c89eeb92234bf64f3.jpg)');
		//$('#view').css('background-image', img1);

		//上传封面
		//document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
		var clipArea = new bjj.PhotoClip("#clipArea", {
			size : [ 321, 321 ],// 截取框的宽和高组成的数组。默认值为[260,260]
			outputSize : [ 321, 321 ], // 输出图像的宽和高组成的数组。默认值为[0,0]，表示输出图像原始大小
			//outputType: "jpg", // 指定输出图片的类型，可选 "jpg" 和 "png" 两种种类型，默认为 "jpg"
			file : "#file", // 上传图片的<input type="file">控件的选择器或者DOM对象
			view : "#view", // 显示截取后图像的容器的选择器或者DOM对象
			ok : "#clipBtn", // 确认截图按钮的选择器或者DOM对象
			loadStart : function(file) {
				// 开始加载的回调函数。this指向 fileReader 对象，并将正在加载的 file 对象作为参数传入
				$('.cover-wrap').fadeIn();//fadeIn（渐显）
				console.log("照片读取中");
			},
			loadComplete : function(src) {
				// 加载完成的回调函数。this指向图片对象，并将图片地址作为参数传入
				console.log("照片读取完成");
			},
			//loadError: function(event) {}, // 加载失败的回调函数。this指向 fileReader 对象，并将错误事件的 event 对象作为参数传入
			clipFinish : function(dataURL) {
				// 裁剪完成的回调函数。this指向图片对象，会将裁剪出的图像数据DataURL作为参数传入
				$('.cover-wrap').fadeOut();//（渐隐）
				$('#view').css('background-size', '100% 100%');
				//localStorage.setItem('dataUrl', dataURL);
				document.getElementById('base64').value = dataURL;
				var img ="url("+dataURL+")";
				$('#view').css('background-image',img);
			}
		});
		//clipArea.destroy();
	</script>
	
	<script type="text/javascript">
		<!-- 搜索框的 -->
			$("#box_sousuo").bsSuggest({
				emptyTip : '未检索到匹配的数据',
				allowNoKeyword : false, //是否允许无关键字时请求数据。为 false 则无输入时不执行过滤请求
				ignorecase : true,
				showBtn : false, //不显示下拉按钮
				multiWord : true, //以分隔符号分割的多关键字支持
				separator : ",", //多关键字支持时的分隔符，默认为空格
				getDataMethod : "url", //获取数据的方式，总是从 URL 获取
				url : 'http://unionsug.baidu.com/su?p=3&wd=', //优先从url ajax 请求 json 帮助数据，注意最后一个参数为关键字请求参数
				jsonp : 'cb', //如果从 url 获取数据，并且需要跨域，则该参数必须设置
				fnProcessData : function(json) { // url 获取数据时，对数据的处理，作为 fnGetData 的回调函数
					var index, len, data = {
						value : []
					};
					if (!json || !json.s || json.s.length === 0) {
						return false;
					}

					len = json.s.length;

					for (index = 0; index < len; index++) {
						data.value.push({
							word : json.s[index]
						});
					}
					data.defaults = 'baidu';

					//字符串转化为 js 对象
					return data;
				}
			}).on('onDataRequestSuccess', function(e, result) {
				console.log('onDataRequestSuccess: ', result);
			}).on('onSetSelectValue', function(e, keyword, data) {
				console.log('onSetSelectValue: ', keyword, data);
				//有时间实现ajax调用后台查询，并跳转到查询结果页
				//没时间就暂时跳到百度页面
				//询问框

			}).on('onUnsetSelectValue', function() {
				console.log("onUnsetSelectValue");
			});
			//回车搜索
			$("#box_sousuo")
					.on(
							'keypress',
							function(e) {
								if (e.keyCode == 13) {
									var text = $(this).val()
									layer
											.confirm(
													'C酱不会搜索,帮您到度娘那里问问,可以吗',
													{
														btn : [ '确定', '再想想' ], //按钮
														shade : false
													//不显示遮罩
													},
													function(index) {
														window
																.open('https://www.baidu.com/s?ie=utf-8&wd='
																		+ text);
														//https://www.baidu.com/s?ie=utf-8&wd=%E6%97%A5%E6%9C%AC&si=163.com&ct=2097152
														layer.close(index);
													}, function() {
													});
								}
								;
							})<!-- 搜索框的 -->
		</script>
</body>
</html>
