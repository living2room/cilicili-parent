<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="../css/stylef.css" />
<link rel="stylesheet" type="text/css" href="/css/animate.css" />
<script src="/webjars/jquery/3.2.1/dist/jquery.min.js"></script>
<!-- 搜索框的 -->
<script type="text/javascript" src="/js/bootstrap-suggest.min.js"></script>
<!-- 搜索框的 -->
</head>

<body>
	<div class="top">
		<div class="nav">
			<div class="logo">
				<img src="../img/LOGO01.png">
			</div>
			<!-- 搜索框的 -->
				<div id="box">
					<div class="input-group" style="width: 175px;">
						<input type="text" class="form-control" id="box_sousuo"
							placeholder="嗖(。≖ˇェˇ≖｡)...">
						<div class="input-group-btn">
							<button type="button" class="btn btn-default dropdown-toggle"
								data-toggle="dropdown">
								<span class="caret"></span>
							</button>
							<ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
						</div>
						<!-- /btn-group -->
					</div>
				</div>
				<!-- 搜索框的 -->
			<div class="nav_right">
				<div class="shouye">
					<div class="tubiao">
						<img src="../img/shouye.png">
					</div>
					<div class="nav_text">
						<a href="/to/home" style="color: #00b7ee;">首页</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/shangchuan.png">
					</div>
					<div class="nav_text">
						<a href="/to/up">上传</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/tuiguang.png">
					</div>
					<div class="nav_text">
						<a href="/Message/reveiceBox">消息</a>
					</div>
				</div>
				<div class="shcngchuan">
					<div class="tubiao">
						<img src="../img/huiyuan.png">
					</div>
					<div class="nav_text">
						<a href="/PaymentBuyVip/Buy">会员</a>
					</div>
				</div>
				<div class="shcngchuan">
					<
					<!-- div class="tubiao"><img src="../img/yonghu.png" ></div>
						<div class="nav_text"><a href="Login.html">登录</a></div> -->



					<div th:if="${session.user}">
						<a
							th:href="@{'/message/usersMessage?userName='+${session.userName}}"><div
								id="view1"
								style="width: 50px; height: 50px; -moz-background-size: 100% 100%; background-size: 100% 100%; border-radius: 50%;">
							</div></a>

					</div>
					<div th:unless="${session.user}">
						<a href="/user/toLogin">
							<div class="tubiao">
								<img src="/img/yonghu.png">
							</div>
							<div class="nav_text">登录</div>
						</a>
					</div>

<div th:if="${session.user}">
			<!---------------------------- 弹窗开始 --------------------------------->
			<div class="tanchuang"
				style="display: none; width: 115px; height: 124px; background: #fFF; z-index: 1000; position: absolute; top: 80px; left: 1494px; opacity: 0.6; border-radius: 10px;">

				<div class="lianjie1 "
					style="height: 15px; width: 180px; line-height: 24px; margin-left: 18px; margin-top: 6px;">
					<div class="dayuhao "
						style="float: left; color: #00a1d6; font-weight: bolder">></div>
					<a th:href="@{/message/usersMessage(userName=${session.userName})}" style="margin-left: 10px;"> <em>修改用户信息<i></i></em>
					</a>
				</div>
				<br>

				<div class="lianjie1"
					style="height: 15px; width: 180px; line-height: 24px; margin-left: 18px;">
					<div class="dayuhao"
						style="float: left; color: #00a1d6; font-weight: bolder">></div>
					<a th:href="@{/user/toUpPassword}" style="margin-left: 10px;"> <em>修改密码<i></i></em>
					</a>
				</div>
				<br>

				<div class="lianjie1"
					style="height: 15px; width: 180px; line-height: 24px; margin-left: 18px;">
					<div class="dayuhao"
						style="float: left; color: #00a1d6; font-weight: bolder">></div>
					<a th:href="@{/user/logout}" style="margin-left: 10px;"> <em>退出登录<i></i></em>
					</a>
				</div><br>
				<div class="lianjie1"
					style="height: 15px; width: 200px; line-height: 24px; margin-left: 18px;">
					<div class="dayuhao"
						style="float: left; color: #00a1d6; font-weight: bolder">></div>
					<a th:href="@{/storage}" style="margin-left: 10px;"> <em>刷脸登录设置<i></i></em>
					</a>
				</div>


			</div>
			<!---------------------------- 弹窗结束 --------------------------------->
		

				</div>
				
				
				<input type="hidden" id="img" th:value="${session.url1}">
					<!-- 登录按钮替换为头像 -->
					<script type="text/javascript">
					var img6 = $("#img").val();
					var img5 ="url("+img6+")";
					$("#view1").css('background-image',img5);	
					</script>
			</div>
		</div>
	</div>
	<div class="password01_top_img"></div>
	<div class="password01_nav">
		<div class="password01_nav_text">
			<a href="Login.html">登录</a>&nbsp;>&nbsp;修改密码
		</div>
	</div>
	<br>
	<br>
	<br>

	<div class="input-group " style="margin-left: 750px;">
		<span class="input-group-addon">旧密码</span> <input type="password"
			name="userPassword" id="userPassword" class="form-control"
			placeholder="请输入您要旧密码" style="width: 330px;">
	</div>
	<label id="p" style="margin-left: 750px;"></label>
	<br />
	<div class="input-group" style="margin-left: 750px;">
		<span class="input-group-addon"> 新密码</span> <input type="password"
			name="newPassword" id="newPassword" class="form-control"
			placeholder="请输入您要 新密码" style="width: 330px;">
	</div>
	<label id="np" style="margin-left: 750px;"></label>

	<br />
	<br />
	<button type="button" id="ok" class="btn btn-primary"
		style="height: 40px; width: 300px; background: #00a1d6; font-size: 16px; margin-left: 810px; border: none;">确认修改</button>
	<input type="hidden" id="userName" th:value="${session.userName}">

	<script type="text/javascript">
		$("#ok").click(function() {
			var userPassword = $("#userPassword").val();
			var newPassword = $("#newPassword").val();
			if (newPassword == "" || newPassword == null) {
				$("#newPassword").focus();
				$("#newPassword").css("color", "red");
				$("#np").html("请输入新密码");
				return false;
			} else if (userPassword == "" || userPassword == null) {
				$("#userPassword").focus();
				$("#userPassword").css("color", "red");
				$("#p").html("请输入旧密码");
				return false;
			} else {
				$.ajax({
					type : "POST",
					url : "/user/upPassword",
					data : {
						"newPassword" : $("#newPassword").val(),
						"userPassword" : $("#userPassword").val(),
						"userName" : $("#userName").val(),
					},
					dataType : "json",

					success : function(data) {
						if (data["msg"] == 1) {
							$("#np").html("修改成功");
							(function() {
								location.href = "/user/index";
							})();
						} else if (data["msg"] == 0) {
							$("#p").html("旧密码输入错误");
							/* 	(function() {
									location.href = "/user/index";
								})(); */
						}
					},
					error : function(data) {
						//alert("邮箱或密码错误");	
						$("#np").html("提交失败" + data);
					}

				});

			}
		});
	</script>

<script type="text/javascript">
		<!-- 搜索框的 -->
			$("#box_sousuo").bsSuggest({
				emptyTip : '未检索到匹配的数据',
				allowNoKeyword : false, //是否允许无关键字时请求数据。为 false 则无输入时不执行过滤请求
				ignorecase : true,
				showBtn : false, //不显示下拉按钮
				multiWord : true, //以分隔符号分割的多关键字支持
				separator : ",", //多关键字支持时的分隔符，默认为空格
				getDataMethod : "url", //获取数据的方式，总是从 URL 获取
				url : 'http://unionsug.baidu.com/su?p=3&wd=', //优先从url ajax 请求 json 帮助数据，注意最后一个参数为关键字请求参数
				jsonp : 'cb', //如果从 url 获取数据，并且需要跨域，则该参数必须设置
				fnProcessData : function(json) { // url 获取数据时，对数据的处理，作为 fnGetData 的回调函数
					var index, len, data = {
						value : []
					};
					if (!json || !json.s || json.s.length === 0) {
						return false;
					}

					len = json.s.length;

					for (index = 0; index < len; index++) {
						data.value.push({
							word : json.s[index]
						});
					}
					data.defaults = 'baidu';

					//字符串转化为 js 对象
					return data;
				}
			}).on('onDataRequestSuccess', function(e, result) {
				console.log('onDataRequestSuccess: ', result);
			}).on('onSetSelectValue', function(e, keyword, data) {
				console.log('onSetSelectValue: ', keyword, data);
				//有时间实现ajax调用后台查询，并跳转到查询结果页
				//没时间就暂时跳到百度页面
				//询问框

			}).on('onUnsetSelectValue', function() {
				console.log("onUnsetSelectValue");
			});
			//回车搜索
			$("#box_sousuo")
					.on(
							'keypress',
							function(e) {
								if (e.keyCode == 13) {
									var text = $(this).val()
									layer
											.confirm(
													'C酱不会搜索,帮您到度娘那里问问,可以吗',
													{
														btn : [ '确定', '再想想' ], //按钮
														shade : false
													//不显示遮罩
													},
													function(index) {
														window
																.open('https://www.baidu.com/s?ie=utf-8&wd='
																		+ text);
														//https://www.baidu.com/s?ie=utf-8&wd=%E6%97%A5%E6%9C%AC&si=163.com&ct=2097152
														layer.close(index);
													}, function() {
													});
								}
								;
							})<!-- 搜索框的 -->
		</script>
				<script type="text/javascript">
		$(".lianjie1").hover(function() {
			/* Stuff to do when the mouse enters the element */
			$(this).children(" .dayuhao").addClass("animated fadeInLeftBig myanimation");
		}, function() {
			/* Stuff to do when the mouse leaves the element */
			$(this).children(" .dayuhao").removeClass("animated fadeInLeftBig myanimation");
		});
		</script>
</body>
</html>
